{"version":3,"sources":["components/Item/item-title.module.scss","utils/api.ts","components/Item/item-details.module.scss","components/Item/item-title.tsx","components/Item/item-details.tsx","components/Item/item.tsx","components/Item/index.ts","redux/Items/actions.ts","redux/Items/selectors.ts","redux/Items/index.ts","components/ItemList/item-list.module.scss","components/ItemList/item-list.tsx","components/ItemList/index.ts","components/Rules/rules.module.scss","components/Rules/rules.tsx","pages/Show/show-page.tsx","pages/Show/index.ts"],"names":["module","exports","voter","domain","link","HTTP","axios","create","CRUDApi","EntityAPI","_ref","url","Object","_home_frank_Documents_Projects_workjam_hn_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","endpoints","entity","name","createDefaultEndpoints","assign","setOtherEndpoints","resourceUrl","concat","getAll","params","arguments","length","undefined","get","getOne","id","entityToCreate","post","update","entityToUpdate","put","delete","entityName","_this","TOP_STORIES","GET_ALL","getResourceUrl","NEWS_STORIES","NEW_STORIES","SHOW_STORIES","JOB_STORIES","ASK_STORIES","details","getDomain","URL","hostname","replace","ItemTitle","props","item","index","react","align","href","className","styles","target","title","Link","to","ItemDetails","setCurrentItem","colSpan","score","by","onClick","format","time","Date","toString","descendants","Item","item_title_ItemTitle","item_details_ItemDetails","spacer","__webpack_require__","d","__webpack_exports__","item_Item","createEntity","getAllStoriesByType","type","page","asyncToGenerator","regenerator_default","a","mark","_callee","dispatch","getState","store","pageSize","result","items","itemPromises","wrap","_context","prev","next","toUpperCase","sent","data","filter","deleted","dead","slice","map","abrupt","actionTypes","payload","Promise","all","stop","_x","_x2","apply","setPage","SET_PAGE","currentItemPromise","itemsById","resolve","SET_CURRENT_ITEM","currentItemSelector","state","currentItem","pageSelector","itemsSelector","createSelector","values","isLoadingSelector","isLoading","Items","actions","selectors","root","ItemList","isEmpty_default","cellSpacing","cellPadding","computedIndex","key","item_list_ItemList","small-spacer","medium-spacer","Rules","enhancedShowPage","connect","React","currentUrl","window","location","currentPage","URLSearchParams","search","Number","SiteWrapper","rules_Rules"],"mappings":"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","file":"static/js/5.4558dd46.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"voter\":\"item-title_voter__qViTL\",\"domain\":\"item-title_domain__16bfZ\",\"link\":\"item-title_link__1laQf\"};","import axios from 'axios';\n\nexport const HTTP = axios.create();\n\ninterface IDefaultEndpoints {\n  [key: string]: (...args: any[]) => Promise<any>;\n}\n\ninterface IEndpoints {\n  [key: string]: IDefaultEndpoints;\n}\n\ninterface IEntity {\n  name: string;\n}\n\ninterface IConstructor {\n  url: string;\n}\n\nclass EntityAPI {\n  private readonly url: string;\n  public endpoints: IEndpoints;\n  constructor({ url }: IConstructor) {\n    this.url = url;\n    this.endpoints = {};\n  }\n\n  public createEntity(entity: IEntity) {\n    this.endpoints[entity.name] = this.createDefaultEndpoints(entity);\n    Object.assign(this.endpoints, this.setOtherEndpoints());\n  }\n\n  private createDefaultEndpoints(entity: IEntity) {\n    const endpoints: IDefaultEndpoints = {};\n    const resourceUrl = `${this.url}/${entity.name}`;\n\n    endpoints.getAll = (params: any = {}) => HTTP.get(resourceUrl, { params });\n\n    endpoints.getOne = (id: string, params?: any) =>\n      HTTP.get(`${resourceUrl}/${id}.json`, { params });\n\n    endpoints.create = (entityToCreate: any) =>\n      HTTP.post(resourceUrl, entityToCreate);\n\n    endpoints.update = (id: string, entityToUpdate: any) =>\n      HTTP.put(`${resourceUrl}/${id}`, entityToUpdate);\n\n    endpoints.delete = (id: string) => HTTP.delete(`${resourceUrl}/${id}`);\n\n    return endpoints;\n  }\n\n  private getResourceUrl(entityName: string): string {\n    return `${this.url}/${entityName}`;\n  }\n\n  // TODO: Rewrite this to be.. well... better\n  private setOtherEndpoints() {\n    return {\n      TOP_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('topstories.json')}`),\n      },\n      NEWS_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('beststories.json')}`),\n      },\n      NEW_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('newstories.json')}`),\n      },\n      SHOW_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('showstories.json')}`),\n      },\n      JOB_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('jobstories.json')}`),\n      },\n      ASK_STORIES: {\n        GET_ALL: () => HTTP.get(`${this.getResourceUrl('askstories.json')}`),\n      }\n    };\n  }\n}\n\nexport const CRUDApi = new EntityAPI({ url: 'https://hacker-news.firebaseio.com/v0' });\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"details\":\"item-details_details__2ZwlC\"};","import * as React from 'react';\nimport { IItem } from '../../redux/Items/types';\nimport styles from './item-title.module.scss';\nimport { Link } from 'react-router-dom';\n\ninterface IProps {\n  index?: number;\n  item: IItem;\n}\n\nfunction getDomain(url: string | undefined): string {\n  if (!url) {\n    return '';\n  }\n  return new URL(url).hostname.replace('www.', '');\n}\n\nconst ItemTitle: React.FunctionComponent<IProps> = (props: IProps) => {\n  const { item, index } = props;\n  return (\n    <tr>\n      {\n        <td align={'right'}>\n          <span>{index && `${index}.`}</span>\n        </td>\n      }\n      <td>\n        <a href={`https://news.ycombinator.com/vote?id=${item.id}&how=up`}>\n          <div className={styles.voter} />\n        </a>\n      </td>\n      <td>\n        {item.url ? (\n          <a target={'_blank'} href={item.url}>\n            {item.title}\n          </a>\n        ) : (\n          <Link to={`/item?id=${item.id}`}>{item.title}</Link>\n        )}{' '}\n        <span className={styles.domain}>\n          {item.url && (\n            <>\n              {'('}\n              <a\n                className={styles.link}\n                href={`https://news.ycombinator.com/from?site=${getDomain(\n                  item.url\n                )}`}\n              >\n                {getDomain(item.url)}\n              </a>\n              {')'}\n            </>\n          )}\n        </span>\n      </td>\n    </tr>\n  );\n};\n\nexport { ItemTitle };\n","import * as React from 'react';\nimport { IItem } from '../../redux/Items/types';\nimport { format } from 'timeago.js';\nimport styles from './item-details.module.scss';\nimport { Link } from 'react-router-dom';\n\ninterface IProps {\n  item: IItem;\n  index?: number;\n  setCurrentItem: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nconst ItemDetails: React.FunctionComponent<IProps> = (props: IProps) => {\n  const { item, setCurrentItem, index } = props;\n  const spacer = ' | ';\n  return (\n    <tr>\n      <td colSpan={2} />\n      <td className={styles.details}>\n        <span>{item.score} points</span>\n        {' by '}\n        <a href={`https://news.ycombinator.com/user?id=${item.by}`}>\n          {item.by}\n        </a>{' '}\n        <span>\n          <Link onClick={setCurrentItem} to={`/item?id=${item.id}`}>\n            {format(item.time, new Date().toString())}\n          </Link>\n        </span>\n        {spacer}\n        <a href={`https://news.ycombinator.com/hide?id=${item.id}`}>hide</a>\n        {spacer}\n        {!index && (\n          <>\n            <a href={`https://hn.algolia.com/?query=${item.title}&sort=byDate&dateRange=all&type=story&storyText=false&prefix&page=0`}>past</a>\n            {spacer}\n            <a href={`https://hn.algolia.com/?search=${item.title}`}>web</a>\n            {spacer}\n            <a href={`https://news.ycombinator.com/fave?id=${item.id}`}>\n              favorite\n            </a>\n            {spacer}\n          </>\n        )}\n        <Link onClick={setCurrentItem} to={`/item?id=${item.id}`}>\n          {item.descendants} comments\n        </Link>\n      </td>\n    </tr>\n  );\n};\n\nexport { ItemDetails };\n","import * as React from 'react';\nimport { IItem } from '../../redux/Items/types';\nimport styles from './item-title.module.scss';\nimport { ItemTitle } from './item-title';\nimport { ItemDetails } from './item-details';\n\ninterface IProps {\n  item: IItem;\n  index?: number;\n  setCurrentItem: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nconst Item: React.FunctionComponent<IProps> = (props: IProps) => {\n  const { index, item, setCurrentItem } = props;\n  return (\n    <>\n      <ItemTitle item={item} index={index} />\n      <ItemDetails setCurrentItem={setCurrentItem} item={item} index={index} />\n      <tr className={styles.spacer} />\n    </>\n  );\n};\n\nexport { Item };\n","export { Item } from './item';\n","import { actionTypes } from './action-types';\nimport { AnyAction, Dispatch } from 'redux';\nimport { CRUDApi } from '../../utils/api';\nimport { AxiosResponse } from 'axios';\nimport { IState } from '../types';\nimport { IItem } from './types';\n\nCRUDApi.createEntity({ name: 'item' });\n\nexport const getAllStoriesByType = (type: string, page: number = 1) => async (\n  dispatch: Dispatch,\n  getState: Function\n) => {\n  const store: IState = getState();\n  const pageSize = store.items.pageSize;\n  const result: AxiosResponse = await CRUDApi.endpoints[\n    `${type.toUpperCase()}_STORIES`\n  ].GET_ALL();\n  const items = result.data\n    .filter((item: IItem) => !item.deleted && !item.dead)\n    .slice(page * pageSize - pageSize, page * pageSize);\n  const itemPromises = items.map((item: number) =>\n    CRUDApi.endpoints.item.getOne(item)\n  );\n\n  return dispatch({\n    type: actionTypes.GET_ALL,\n    payload: Promise.all(itemPromises),\n  });\n};\n\nexport const setPage = (page: number) => {\n  return {\n    type: actionTypes.SET_PAGE,\n    payload: { page },\n  };\n};\n\nexport const setCurrentItem = (id: number | null) => (\n  dispatch: Dispatch,\n  getState: Function\n) => {\n  const store = getState();\n  const itemsById = store.items.itemsById;\n  let currentItemPromise;\n\n  if (!id) {\n    currentItemPromise = new Promise((resolve) => resolve({ data: null }));\n  } else if (!itemsById[id]) {\n    currentItemPromise = CRUDApi.endpoints.item.getOne(id);\n  } else {\n    currentItemPromise = new Promise((resolve) =>\n      resolve({ data: itemsById[id] })\n    );\n  }\n\n  return dispatch({\n    type: actionTypes.SET_CURRENT_ITEM,\n    payload: currentItemPromise,\n  });\n};\n","import { createSelector } from 'reselect';\nimport { IState } from '../types';\n\nconst itemsStoreSelector = (state: IState) => state.items;\nconst itemsByIdSelector = (state: IState) => state.items.itemsById;\nexport const currentItemSelector = (state: IState) => state.items.currentItem;\nexport const pageSelector = (state: IState) => state.items.page;\n\nexport const itemsSelector = createSelector(\n  [itemsByIdSelector],\n  (itemsById) => {\n    return Object.values(itemsById);\n  }\n);\n\nexport const isLoadingSelector = createSelector(\n  [itemsStoreSelector],\n  ({ isLoading }): boolean => isLoading as boolean\n);\n","import * as actions from './actions';\nimport { actionTypes } from './action-types';\nimport * as selectors from './selectors';\nexport { reducer } from './reducer';\nexport { actions };\nexport { actionTypes };\n\nconst Items = {\n  actions,\n  actionTypes,\n  selectors,\n};\n\nexport { Items };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"item-list_root__1ZD8i\",\"spacer\":\"item-list_spacer__1KJ56\"};","import * as React from 'react';\nimport { IItem } from '../../redux/Items/types';\nimport { isEmpty } from 'lodash';\nimport { Item } from '../Item';\nimport styles from './item-list.module.scss';\nimport { Link } from 'react-router-dom';\n\ninterface IProps {\n  items: IItem[];\n  page: number;\n  pageSize: number;\n  onClick: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n  setCurrentItem: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nconst ItemList: React.FunctionComponent<IProps> = (props: IProps) => {\n  const { items, page, onClick, pageSize, setCurrentItem } = props;\n\n  if (isEmpty(items)) {\n    return null;\n  }\n\n  return (\n    <table className={styles.root} cellSpacing={0} cellPadding={0}>\n      <tbody>\n        {items.map((item, index) => {\n          const computedIndex = index + 1 + pageSize * (page - 1);\n          return (\n            <Item\n              setCurrentItem={setCurrentItem}\n              key={item.id}\n              item={item}\n              index={computedIndex}\n            />\n          );\n        })}\n        <tr className={styles.spacer} />\n        <tr>\n          <td colSpan={2} />\n          <td>\n            <Link onClick={onClick} to={`?page=${page + 1}`}>\n              More\n            </Link>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n};\n\nexport { ItemList };\n","export { ItemList } from './item-list';\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"small-spacer\":\"rules_small-spacer__1aAoQ\",\"medium-spacer\":\"rules_medium-spacer__KBDL1\"};","import * as React from 'react';\nimport styles from './rules.module.scss';\n\nconst Rules: React.FunctionComponent = () => {\n  return (\n    <table>\n      <tbody>\n      <tr className={styles['small-spacer']} />\n      <tr>\n        <td colSpan={2} />\n        <td>\n          Please read the{' '}\n          <a href=\"https://news.ycombinator.com/showhn\">\n            <u>rules</u>\n          </a>\n          . You can also browse the{' '}\n          <a href=\"https://news.ycombinator.com/shownew\">\n            <u>newest</u>\n          </a>{' '}\n          Show HNs.\n        </td>\n      </tr>\n      <tr className={styles['medium-spacer']} />\n      </tbody>\n    </table>\n  );\n};\n\nexport { Rules };\n","import * as React from 'react';\nimport { SiteWrapper } from '../../layout/SiteWrapper';\nimport { connect } from 'react-redux';\nimport { IState, IAction } from '../../redux/types';\nimport { Dispatch } from 'redux';\nimport { ItemList } from '../../components/ItemList';\nimport { IItem } from '../../redux/Items/types';\nimport { Items } from '../../redux/Items';\nimport { isEmpty } from 'lodash';\nimport { Rules } from '../../components/Rules/';\n\ninterface IStateProps {\n  items: IItem[];\n  isLoading: boolean;\n  page: number;\n  pageSize: number;\n}\n\nconst mapStateToProps = (state: IState): IStateProps => ({\n  items: Items.selectors.itemsSelector(state),\n  isLoading: Items.selectors.isLoadingSelector(state),\n  page: Items.selectors.pageSelector(state),\n  pageSize: state.items.pageSize,\n});\n\ninterface IDispatch {\n  dispatch: Dispatch<IAction>;\n}\n\ntype IComponentProps = IStateProps & IDispatch;\n\nconst ShowPage: React.FunctionComponent<IComponentProps> = (\n  props: IComponentProps,\n) => {\n  const { items, isLoading, dispatch, page, pageSize } = props;\n\n  React.useEffect(() => {\n    const currentUrl = new URL(window.location.href);\n    const searchParams = new URLSearchParams(currentUrl.search);\n    const currentPage = searchParams.get('page');\n\n    if (!currentPage) {\n      return;\n    }\n\n    dispatch(Items.actions.setPage(Number(currentPage)));\n  }, []);\n\n  React.useEffect(\n    () => {\n      dispatch(Items.actions.getAllStoriesByType('show', page));\n    },\n    [page],\n  );\n\n  const handleClick: React.MouseEventHandler<HTMLAnchorElement> = (): void => {\n    dispatch(Items.actions.setPage(page + 1));\n  };\n\n  const handleSetCurrentItem: React.MouseEventHandler<\n    HTMLAnchorElement\n  > = () => (id: number): void => {\n    dispatch(Items.actions.setCurrentItem(id));\n  };\n\n  return (\n    <SiteWrapper>\n      {isLoading || isEmpty(items) ? (\n        <div>Loading...</div>\n      ) : (\n        <>\n          <Rules />\n          <ItemList\n            items={items}\n            page={page}\n            pageSize={pageSize}\n            onClick={handleClick}\n            setCurrentItem={handleSetCurrentItem}\n          />\n        </>\n      )}\n    </SiteWrapper>\n  );\n};\n\nconst enhancedShowPage = connect(mapStateToProps)(ShowPage);\n\nexport { enhancedShowPage as ShowPage };\n","export { ShowPage } from './show-page';\n"],"sourceRoot":""}